<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Objednávkový systém</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-5">
    <h1 class="text-center">Objednávkový systém</h1>
    <form id="orderForm">
      <div class="mb-3">
        <label for="table" class="form-label">Číslo stolu:</label>
        <input type="number" class="form-control" id="table" required>
      </div>
      <h3>Předkrmy</h3>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Bruschetta" data-price="100"> Bruschetta (100 Kč)
        </label>
      </div>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Caprese" data-price="120"> Caprese (120 Kč)
        </label>
      </div>
      <h3>Polévky</h3>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Rajčatová polévka" data-price="90"> Rajčatová polévka (90 Kč)
        </label>
      </div>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Kuřecí vývar" data-price="80"> Kuřecí vývar (80 Kč)
        </label>
      </div>
      <h3>Hlavní jídla</h3>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Pizza Margherita" data-price="180"> Pizza Margherita (180 Kč)
        </label>
      </div>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Hovězí steak" data-price="350"> Hovězí steak (350 Kč)
        </label>
      </div>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Těstoviny Carbonara" data-price="220"> Těstoviny Carbonara (220 Kč)
        </label>
      </div>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Grilované kuře" data-price="250"> Grilované kuře (250 Kč)
        </label>
      </div>
      <h3>Dezerty</h3>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Tiramisu" data-price="120"> Tiramisu (120 Kč)
        </label>
      </div>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Panna Cotta" data-price="110"> Panna Cotta (110 Kč)
        </label>
      </div>
      <h3>Teplé nápoje</h3>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Espresso" data-price="50"> Espresso (50 Kč)
        </label>
      </div>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Cappuccino" data-price="70"> Cappuccino (70 Kč)
        </label>
      </div>
      <h3>Studené nápoje</h3>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Minerálka" data-price="40"> Minerálka (40 Kč)
        </label>
      </div>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Coca Cola" data-price="50"> Coca Cola (50 Kč)
        </label>
      </div>
      <div class="mb-3">
        <label>
          <input type="checkbox" value="Džus" data-price="60"> Džus (60 Kč)
        </label>
      </div>
      <button type="button" id="submitOrder" class="btn btn-primary">Potvrdit objednávku</button>
    </form>
  </div>

  <script>
    document.getElementById('submitOrder').addEventListener('click', async () => {
      const table = document.getElementById('table').value;
      const items = [...document.querySelectorAll('input[type="checkbox"]:checked')].map(item => ({
        name: item.value,
        price: item.dataset.price,
        qty: 1
      }));

      if (!table || items.length === 0) {
        alert('Vyplňte číslo stolu a vyberte položky.');
        return;
      }

      try {
        const response = await fetch('https://restaurant-ordering-backend.onrender.com/api/orders', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ tableNumber: parseInt(table), items }),
        });

        if (response.ok) {
          alert('Objednávka odeslána.');
          window.location.href = 'customer-orders.html'; // Přesměrování na zákaznickou stránku
        } else {
          alert('Chyba při odesílání objednávky.');
        }
      } catch (err) {
        console.error('Chyba:', err);
        alert('Chyba při odesílání objednávky.');
      }
    });
  </script>
</body>
</html>
